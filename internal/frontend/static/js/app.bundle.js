(()=>{var fe=Object.defineProperty,ve=Object.defineProperties;var ge=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var he=Object.prototype.hasOwnProperty,ye=Object.prototype.propertyIsEnumerable;var ne=(e,t,o)=>t in e?fe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,v=(e,t)=>{for(var o in t||(t={}))he.call(t,o)&&ne(e,o,t[o]);if(oe)for(var o of oe(t))ye.call(t,o)&&ne(e,o,t[o]);return e},h=(e,t)=>ve(e,ge(t));function q(){let{useState:e,useEffect:t}=React,[o,n]=e(window.location.hash||"#/");return t(()=>{let i=()=>n(window.location.hash||"#/");return window.addEventListener("hashchange",i),()=>window.removeEventListener("hashchange",i)},[]),o}var Ne={async request(e,t={}){let o=t.headers||{},n=t.method||"GET";["POST","PUT","PATCH","DELETE"].includes(n.toUpperCase())&&(o["X-CSRF-Token"]="1"),!(typeof FormData!="undefined"&&t.body instanceof FormData)&&!o["Content-Type"]&&(o["Content-Type"]="application/json");let a=await fetch(e,h(v({},t),{headers:o,credentials:"include"}));if(a.status===401)throw new Error("unauthorized");if(a.status===204)return null;let c=await a.json().catch(()=>({}));if(!a.ok)throw new Error(c.error||"HTTP "+a.status);return c},get(e,t){return this.request(e,t)},post(e,t){let o=typeof FormData!="undefined"&&t instanceof FormData;return this.request(e,o?{method:"POST",body:t}:{method:"POST",body:JSON.stringify(t)})},put(e,t){let o=typeof FormData!="undefined"&&t instanceof FormData;return this.request(e,o?{method:"PUT",body:t}:{method:"PUT",body:JSON.stringify(t)})},patch(e,t){let o=typeof FormData!="undefined"&&t instanceof FormData;return this.request(e,o?{method:"PATCH",body:t}:{method:"PATCH",body:JSON.stringify(t)})},del(e){return this.request(e,{method:"DELETE"})}},u=Ne;function H(){let{useState:e,useEffect:t}=React,[o,n]=e({googleEnabled:!1,oidcEnabled:!1,devLogin:!1}),[i,a]=e(null),[c,l]=e(localStorage.getItem("theme")||"dark");return t(()=>{document.documentElement.setAttribute("data-bs-theme",c),localStorage.setItem("theme",c)},[c]),t(()=>{fetch("/.well-known/oauth-authorization-server").then(m=>m.json()).then(m=>{let f=m.x_catwatch_config||{};n({googleEnabled:!!f.google_enabled,oidcEnabled:!!f.oidc_enabled,devLogin:!!f.dev_login,authorizationEndpoint:m.authorization_endpoint})}).catch(()=>{})},[]),t(()=>{u.get("/api/user").then(a).catch(()=>a(null))},[]),{config:o,user:i,setUser:a,theme:c,setTheme:l}}function j({user:e,size:t=32,className:o="",title:n=""}){let{name:i,avatar_url:a}=e||{},c={width:t+"px",height:t+"px",borderRadius:"50%",objectFit:"cover"};if(a)return React.createElement("img",{src:a,style:c,className:o,alt:i,title:n||i});let l=i?i.charAt(0).toUpperCase():"?",m=h(v({},c),{backgroundColor:"#6c757d",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:t/2+"px",fontWeight:"bold"});return React.createElement("div",{style:m,className:o,title:n||i},l)}function Y({theme:e,setTheme:t,user:o}){let{useState:n,useEffect:i}=React,[a,c]=n(!1);return i(()=>{let l=()=>{try{let f=(window.location.hash||"#/").split("?")[0]||"#/";c(!(f==="#/"||f==="#"))}catch(m){c(!1)}};return l(),window.addEventListener("hashchange",l),()=>window.removeEventListener("hashchange",l)},[]),React.createElement("nav",{className:"navbar sticky-top bg-body-tertiary border-bottom"},React.createElement("div",{className:"container-fluid px-3 d-flex align-items-center"},a?React.createElement("button",{className:"btn btn-link text-decoration-none me-2 d-flex align-items-center",type:"button",onClick:()=>window.history.back()},React.createElement("i",{className:"fa-solid fa-chevron-left me-1"}),React.createElement("span",null,"Back")):React.createElement("div",{className:"dropdown me-2"},React.createElement("button",{className:"btn btn-link text-decoration-none d-flex align-items-center",type:"button","data-bs-toggle":"dropdown"},React.createElement("i",{className:"fa-solid fa-ellipsis"})),React.createElement("div",{className:"dropdown-menu dropdown-menu-start p-2"},React.createElement("button",{className:"dropdown-item",type:"button",onClick:()=>t(e==="dark"?"light":"dark")},React.createElement("i",{className:e==="dark"?"fa-solid fa-sun me-2":"fa-solid fa-moon me-2"}),e==="dark"?"Light theme":"Dark theme"),o&&React.createElement(React.Fragment,null,React.createElement("div",{className:"dropdown-divider"}),React.createElement("a",{href:"#/cat/new",className:"dropdown-item"},React.createElement("i",{className:"fa-solid fa-plus me-2"}),"Add cat"),React.createElement("a",{href:"#/upcoming",className:"dropdown-item"},React.createElement("i",{className:"fa-solid fa-calendar-day me-2"}),"Upcoming"),React.createElement("a",{href:"#/me",className:"dropdown-item"},React.createElement("i",{className:"fa-solid fa-user me-2"}),"My profile")))),React.createElement("a",{className:"navbar-brand fw-bold d-flex align-items-center mx-auto",href:"#/"},React.createElement("i",{className:"fa-solid fa-cat me-2"}),React.createElement("span",null,"CatWatch")),React.createElement("div",{className:"d-flex align-items-center"},o?React.createElement("a",{href:"#/me",className:"d-inline-flex align-items-center justify-content-center ms-1"},React.createElement(j,{user:o,size:32,className:"border"})):React.createElement("a",{href:"#/signin",className:"btn btn-link text-decoration-none"},React.createElement("i",{className:"fa-solid fa-user"})))))}async function B(e,t,o,n,i,a,c){if(!t){window.location.hash="#/signin";return}let l=!!o,m=Number(n)||0,f=!l;i(f),a(m+(f?1:-1));try{let y=await u.post(`/api/cats/${e}/like`,{});y&&(typeof y.liked=="boolean"&&i(y.liked),typeof y.likes=="number"&&a(y.likes),l&&!y.liked&&c&&c(e))}catch(y){i(l),a(m),alert("Error: "+y.message)}}function z(e,t=300,o=30){let n=React.useRef({t:0,x:0,y:0});return React.useCallback(i=>{try{let a=Date.now(),c=i.clientX||i.changedTouches&&i.changedTouches[0]&&i.changedTouches[0].clientX||0,l=i.clientY||i.changedTouches&&i.changedTouches[0]&&i.changedTouches[0].clientY||0,m=n.current,f=a-(m.t||0),y=c-(m.x||0),C=l-(m.y||0),b=y*y+C*C;if((i.pointerType==="touch"||i.type&&i.type.indexOf("touch")===0)&&f>0&&f<t&&b<o*o){i.preventDefault&&i.preventDefault(),i.stopPropagation&&i.stopPropagation();try{e&&e(i)}catch(N){}n.current={t:0,x:0,y:0}}else n.current={t:a,x:c,y:l}}catch(a){}},[e,t,o])}function I({cat:e,user:t,onUnliked:o}){let{useState:n,useEffect:i}=React,{id:a,name:c,description:l,condition:m,need_attention:f,images:y,last_seen:C,tags:b,color:w}=e,[N,_]=n(e.likes||0),[E,F]=n(!!e.liked);i(()=>{_(e.likes||0),F(!!e.liked)},[e.id,e.likes,e.liked]);let L=k=>{k&&k.preventDefault&&k.preventDefault(),k&&k.stopPropagation&&k.stopPropagation(),B(a,t,E,N,F,_,o)},D=z(L),r=y&&y.length>0?[...y].sort((k,R)=>new Date(R.created_at)-new Date(k.created_at))[0]:null,x=k=>{switch(k){case 1:return"\u{1F640}";case 2:return"\u{1F63F}";case 3:return"\u{1F63A}";case 4:return"\u{1F63D}";case 5:return"\u{1F63B}";default:return"\u{1F431}"}},$=k=>{switch(k){case 1:return"Very Bad";case 2:return"Bad";case 3:return"Normal";case 4:return"Good";case 5:return"Excellent";default:return"Unknown"}},P=f?React.createElement("span",{className:"badge bg-danger me-1"},"\u26A0\uFE0F Needs attention"):null;return React.createElement("div",{className:"card h-100 shadow-sm border-0 bg-body-tertiary overflow-hidden"},React.createElement("div",{className:"position-relative",style:{height:"200px",backgroundColor:"#333"}},r?React.createElement("img",{src:`/api/cats/${a}/images/${r.id}`,className:"card-img-top w-100 h-100 object-fit-cover",alt:c,onPointerUp:D,onDoubleClick:L,style:{touchAction:"manipulation"}}):React.createElement("div",{className:"w-100 h-100 d-flex align-items-center justify-content-center text-secondary"},React.createElement("i",{className:"fa-solid fa-cat fa-4x opacity-25"})),React.createElement("div",{className:"position-absolute top-0 end-0 p-2 d-flex flex-column gap-2 align-items-end",style:{zIndex:10}},React.createElement("span",{className:"badge bg-dark bg-opacity-75 fs-6"},x(m)," ",$(m))),React.createElement("div",{className:"position-absolute bottom-0 end-0 m-2",style:{zIndex:20}},React.createElement("span",{role:"button",tabIndex:0,className:(t?"bg-body-secondary bg-opacity-75":"bg-secondary bg-opacity-25")+" px-2 py-1 small rounded-1 d-inline-flex align-items-center",style:{userSelect:"none",cursor:t?"pointer":"default"},onClick:L,title:t?E?"Remove like":"Like":"Sign in to like"},React.createElement("i",{className:"fa-solid fa-heart me-1 "+(E||N>0?"text-danger":"text-secondary")}),React.createElement("span",null,N)))),React.createElement("div",{className:"card-body d-flex flex-column"},React.createElement("h5",{className:"card-title fw-bold mb-1"},React.createElement("a",{href:`#/cat/view/${a}`,className:"text-decoration-none text-reset"},c)),React.createElement("div",{className:"mb-2"},P,w&&React.createElement("span",{className:"badge bg-secondary-subtle text-secondary border border-secondary border-opacity-25 me-1"},w),b&&b.map(k=>React.createElement("span",{key:k.id,className:"badge bg-secondary me-1"},"#",k.name))),React.createElement("p",{className:"card-text small text-secondary flex-grow-1 text-truncate-2"},l||"No description provided."),React.createElement("div",{className:"mt-2 pt-2 border-top d-flex justify-content-between align-items-center"},React.createElement("span",{className:"small text-body-tertiary"},React.createElement("i",{className:"fa-solid fa-clock me-1"}),C?new Date(C).toLocaleDateString():"Never seen"),React.createElement("a",{href:`#/cat/view/${a}`,className:"btn btn-primary btn-sm rounded-pill px-3"},"Details"))))}function J({user:e}){let{useState:t,useEffect:o}=React,[n,i]=t([]),[a,c]=t(!0),[l,m]=t(null);return o(()=>{u.get("/api/cats/").then(f=>{i(f),c(!1)}).catch(f=>{m(f.message),c(!1)})},[]),a?React.createElement("div",{className:"text-center py-5"},React.createElement("div",{className:"spinner-border text-primary",role:"status"},React.createElement("span",{className:"visually-hidden"},"Loading..."))):l?React.createElement("div",{className:"alert alert-danger",role:"alert"},"Error loading cats: ",l):React.createElement("div",null,React.createElement("div",{className:"d-flex justify-content-end align-items-center mb-4"},e&&React.createElement("a",{href:"#/cat/new",className:"btn btn-primary rounded-pill px-4"},React.createElement("i",{className:"fa-solid fa-plus me-2"}),"Add New Cat")),n.length===0?React.createElement("div",{className:"text-center py-5 bg-body-tertiary rounded-4"},React.createElement("i",{className:"fa-solid fa-cat fa-4x mb-3 opacity-25"}),React.createElement("p",{className:"lead text-secondary"},"No cats found in the registry.")):React.createElement("div",{className:"row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4"},n.map(f=>React.createElement("div",{key:f.id,className:"col"},React.createElement(I,{cat:f,user:e})))))}function X(e,t=[]){let{useEffect:o}=React;o(()=>{let n=e&&"current"in e?e.current:null;if(!n||typeof bootstrap=="undefined"||!bootstrap.Carousel)return;let i=bootstrap.Carousel.getInstance(n)||new bootstrap.Carousel(n,{interval:!1,ride:!1,touch:!0,keyboard:!0,pause:!1,wrap:!0}),a=()=>{try{i.pause&&i.pause()}catch(c){}};return n.addEventListener("slide.bs.carousel",a),n.addEventListener("slid.bs.carousel",a),n.addEventListener("mouseenter",a),n.addEventListener("touchstart",a,{passive:!0}),()=>{try{i.dispose&&i.dispose()}catch(c){}n.removeEventListener("slide.bs.carousel",a),n.removeEventListener("slid.bs.carousel",a),n.removeEventListener("mouseenter",a),n.removeEventListener("touchstart",a)}},t)}var ie=e=>{switch(e){case 1:return"\u{1F640}";case 2:return"\u{1F63F}";case 3:return"\u{1F63A}";case 4:return"\u{1F63D}";case 5:return"\u{1F63B}";default:return"\u{1F431}"}},le=e=>{switch(e){case 1:return"Very Bad";case 2:return"Bad";case 3:return"Normal";case 4:return"Good";case 5:return"Excellent";default:return"Unknown"}};function Q({catId:e,user:t}){let{useState:o,useEffect:n,useRef:i}=React,[a,c]=o(null),[l,m]=o(!0),[f,y]=o(null),[C,b]=o(!1),[w,N]=o(!1),[_,E]=o(!1),[F,L]=o(!1),[D,r]=o({type:"feeding",note:"",planned_at:""}),[x,$]=o({name:"",description:"",lat:"",lon:""}),[P,k]=o({condition:3,note:"Observation via Web UI"}),[R,d]=o(0),[g,S]=o(!1),U=i(null),V=i(null);X(U,[a&&a.id]);let O=s=>{s&&s.stopPropagation&&s.stopPropagation(),B(e,t,g,R,S,d)},re=z(O),A=()=>{u.get(`/api/cats/${e}/`).then(s=>{c(s),d(s.likes||0),S(!!s.liked),k(p=>h(v({},p),{condition:s.condition})),m(!1)}).catch(s=>{y(s.message),m(!1)})};n(()=>{A()},[e]);let de=()=>{V.current.click()},ce=async s=>{let p=s.target.files;if(!(!p||p.length===0)){b(!0);try{for(let T=0;T<p.length;T++){let G=new FormData;G.append("file",p[T]),await u.post(`/api/cats/${e}/images`,G)}A()}catch(T){alert("Upload failed: "+T.message)}finally{b(!1),s.target.value=""}}},M=async(s,p=null)=>{s&&s.preventDefault&&s.preventDefault();let T;p?T=h(v({},p),{done_at:new Date().toISOString()}):(T=v({},D),T.planned_at?T.planned_at=new Date(T.planned_at).toISOString():(delete T.planned_at,T.done_at=new Date().toISOString()));try{await u.post(`/api/cats/${e}/records`,T),p||(r({type:"feeding",note:"",planned_at:""}),N(!1)),A()}catch(G){alert("Failed to add record: "+G.message)}},me=async s=>{s.preventDefault();try{let p={name:x.name,description:x.description,lat:parseFloat(x.lat),lon:parseFloat(x.lon)};if(isNaN(p.lat)||isNaN(p.lon))throw new Error("Invalid coordinates");await u.post(`/api/cats/${e}/locations`,p),$({name:"",description:"",lat:"",lon:""}),E(!1),A()}catch(p){alert("Failed to add location: "+p.message)}},pe=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(s=>{$(p=>h(v({},p),{lat:s.coords.latitude.toFixed(6),lon:s.coords.longitude.toFixed(6)}))},s=>{alert("Geolocation error: "+s.message)}):alert("Geolocation not supported by this browser.")},ue=async s=>{try{await u.post(`/api/cats/${e}/records/${s}/done`,{}),A()}catch(p){alert("Failed to mark as done: "+p.message)}},be=async s=>{s.preventDefault();try{await u.put(`/api/cats/${e}/`,h(v({},a),{condition:P.condition}));let p=`Condition: ${ie(P.condition)} ${le(P.condition)}`;P.note&&P.note!=="Observation via Web UI"&&(p+=`
Note: ${P.note}`),await u.post(`/api/cats/${e}/records`,{type:"observation",note:p,timestamp:new Date().toISOString(),done_at:new Date().toISOString()}),L(!1),A()}catch(p){alert("Observation failed: "+p.message)}};return l?React.createElement("div",{className:"text-center py-5"},React.createElement("div",{className:"spinner-border text-primary",role:"status"},React.createElement("span",{className:"visually-hidden"},"Loading..."))):f?React.createElement("div",{className:"alert alert-danger"},"Error: ",f):a?React.createElement("div",{className:"row g-4"},React.createElement("div",{className:"col-12 col-lg-8"},React.createElement("div",{className:"card border-0 bg-body-tertiary shadow-sm rounded-4 overflow-hidden mb-4"},React.createElement("div",{className:"row g-0"},React.createElement("div",{className:"col-md-5 position-relative",style:{minHeight:"300px",backgroundColor:"#333"}},a.images&&a.images.length>0?React.createElement("div",{ref:U,id:"catImages",className:"carousel slide h-100","data-bs-ride":"carousel","data-bs-interval":"false","data-bs-touch":"true"},React.createElement("div",{className:"carousel-inner h-100"},[...a.images].sort((s,p)=>new Date(p.created_at)-new Date(s.created_at)).map((s,p)=>React.createElement("div",{key:s.id,className:`carousel-item h-100 ${p===0?"active":""}`},React.createElement("img",{src:`/api/cats/${a.id}/images/${s.id}`,className:"d-block w-100 h-100 object-fit-cover",alt:"...",style:{touchAction:"manipulation"},onDoubleClick:O,onPointerUp:re})))),a.images.length>1&&React.createElement(React.Fragment,null,React.createElement("button",{className:"carousel-control-prev",type:"button","data-bs-target":"#catImages","data-bs-slide":"prev"},React.createElement("span",{className:"carousel-control-prev-icon","aria-hidden":"true"})),React.createElement("button",{className:"carousel-control-next",type:"button","data-bs-target":"#catImages","data-bs-slide":"next"},React.createElement("span",{className:"carousel-control-next-icon","aria-hidden":"true"})))):React.createElement("div",{className:"w-100 h-100 d-flex align-items-center justify-content-center text-secondary"},React.createElement("i",{className:"fa-solid fa-cat fa-6x opacity-25"})),React.createElement("div",{className:"position-absolute bottom-0 end-0 m-2",style:{zIndex:20}},React.createElement("span",{role:"button",tabIndex:0,className:(t?"bg-body-secondary bg-opacity-75":"bg-secondary bg-opacity-25")+" px-2 py-1 small rounded-1 d-inline-flex align-items-center",style:{userSelect:"none",cursor:t?"pointer":"default"},onClick:O,title:t?g?"Remove like":"Like":"Sign in to like"},React.createElement("i",{className:"fa-solid fa-heart me-1 "+(g||R>0?"text-danger":"text-secondary")}),React.createElement("span",null,R)))),React.createElement("div",{className:"col-md-7"},React.createElement("div",{className:"card-body p-4"},React.createElement("div",{className:"mb-4"},React.createElement("h2",{className:"card-title fw-bold mb-1"},a.name),React.createElement("div",null,a.need_attention&&React.createElement("span",{className:"badge bg-danger me-2"},"\u26A0\uFE0F Needs attention"),a.tags&&a.tags.map(s=>React.createElement("span",{key:s.id,className:"badge bg-secondary me-1"},"#",s.name)))),React.createElement("div",{className:"mb-4 d-flex align-items-center gap-3"},React.createElement("div",null,React.createElement("h6",{className:"text-secondary text-uppercase small fw-bold mb-2"},"Condition"),React.createElement("div",{className:"fs-4"},ie(a.condition)," ",le(a.condition)))),React.createElement("div",{className:"mb-4"},React.createElement("h6",{className:"text-secondary text-uppercase small fw-bold mb-2"},"Description"),React.createElement("p",{className:"card-text"},a.description||"No description.")),React.createElement("div",{className:"row g-3 small"},React.createElement("div",{className:"col-6"},React.createElement("div",{className:"text-secondary text-uppercase x-small fw-bold"},"Gender"),React.createElement("div",{className:"fw-bold text-capitalize"},a.gender||"Unknown")),React.createElement("div",{className:"col-6"},React.createElement("div",{className:"text-secondary text-uppercase x-small fw-bold"},"Sterilized"),React.createElement("div",{className:"fw-bold"},a.is_sterilized?"Yes":"No")),React.createElement("div",{className:"col-6"},React.createElement("div",{className:"text-secondary text-uppercase x-small fw-bold"},"Color"),React.createElement("div",{className:"fw-bold"},a.color||"Unknown")),React.createElement("div",{className:"col-6"},React.createElement("div",{className:"text-secondary text-uppercase x-small fw-bold"},"Birth Date"),React.createElement("div",{className:"fw-bold"},a.birth_date?new Date(a.birth_date).toLocaleDateString():"Unknown")),React.createElement("div",{className:"col-6"},React.createElement("div",{className:"text-secondary text-uppercase x-small fw-bold"},"Last seen"),React.createElement("div",null,a.last_seen?new Date(a.last_seen).toLocaleString():"Never")),React.createElement("div",{className:"col-6"},React.createElement("div",{className:"text-secondary text-uppercase x-small fw-bold"},"Registered"),React.createElement("div",null,new Date(a.created_at).toLocaleDateString()))))))),t&&React.createElement("div",{className:"mb-4"},React.createElement("div",{className:"d-flex gap-2 flex-wrap justify-content-center justify-content-md-start mb-3"},React.createElement("input",{type:"file",ref:V,onChange:ce,className:"d-none",accept:"image/*",multiple:!0}),React.createElement("button",{className:"btn btn-outline-info btn-sm rounded-pill px-3 py-2",onClick:s=>M(s,{type:"observation",note:"Marked as seen via Web UI"})},React.createElement("i",{className:"fa-solid fa-eye me-1"})," Seen"),React.createElement("button",{className:"btn btn-outline-warning btn-sm rounded-pill px-3 py-2",onClick:s=>M(s,{type:"feeding",note:"Quick feed via Web UI"})},React.createElement("i",{className:"fa-solid fa-bowl-food me-1"})," Feed"),React.createElement("button",{className:"btn btn-outline-success btn-sm rounded-pill px-3 py-2",onClick:()=>L(!F)},React.createElement("i",{className:"fa-solid fa-magnifying-glass me-1"})," Observe"),React.createElement("button",{className:"btn btn-outline-secondary btn-sm rounded-pill px-3 py-2",onClick:de,disabled:C},C?React.createElement("span",{className:"spinner-border spinner-border-sm me-1"}):React.createElement("i",{className:"fa-solid fa-camera me-1"}),"Photo"),React.createElement("a",{href:`#/cat/edit/${a.id}`,className:"btn btn-outline-primary btn-sm rounded-pill px-3 py-2"},React.createElement("i",{className:"fa-solid fa-pen me-1"})," Edit")),F&&React.createElement("div",{className:"p-4 bg-body-tertiary rounded-4 shadow-sm border border-success border-opacity-25"},React.createElement("h6",{className:"fw-bold mb-3 text-success"},React.createElement("i",{className:"fa-solid fa-magnifying-glass me-2"}),"Quick Observation"),React.createElement("form",{onSubmit:be},React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label x-small fw-bold text-uppercase"},"Condition"),React.createElement("select",{className:"form-select form-select-sm bg-dark border-0 text-white mb-2",value:P.condition,onChange:s=>k(h(v({},P),{condition:parseInt(s.target.value)}))},React.createElement("option",{value:"1"},"\u{1F640} 1 - Very Bad"),React.createElement("option",{value:"2"},"\u{1F63F} 2 - Bad"),React.createElement("option",{value:"3"},"\u{1F63A} 3 - Normal"),React.createElement("option",{value:"4"},"\u{1F63D} 4 - Good"),React.createElement("option",{value:"5"},"\u{1F63B} 5 - Excellent"))),React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label x-small fw-bold text-uppercase"},"Observation Note"),React.createElement("textarea",{className:"form-control form-control-sm bg-dark border-0",rows:"2",value:P.note,onChange:s=>k(h(v({},P),{note:s.target.value})),placeholder:"e.g. Looks good, seems healthy..."})),React.createElement("div",{className:"d-flex gap-2"},React.createElement("button",{type:"submit",className:"btn btn-success btn-sm flex-grow-1 rounded-pill"},"Save Observation"),React.createElement("button",{type:"button",className:"btn btn-outline-secondary btn-sm rounded-pill",onClick:()=>L(!1)},"Cancel")),React.createElement("div",{className:"mt-2 text-center"},React.createElement("small",{className:"text-secondary x-small"},'Use "Photo" and "Log Sighting" buttons separately after saving if needed.'))))),React.createElement("div",{className:"card border-0 bg-body-tertiary shadow-sm rounded-4 p-4"},React.createElement("div",{className:"d-flex justify-content-between align-items-center mb-3"},React.createElement("h5",{className:"fw-bold mb-0"},React.createElement("i",{className:"fa-solid fa-location-dot me-2 text-primary"}),"Sightings"),t&&React.createElement("button",{className:"btn btn-outline-primary btn-sm rounded-pill",onClick:()=>E(!_)},React.createElement("i",{className:`fa-solid ${_?"fa-xmark":"fa-plus"} me-1`}),_?"Cancel":"Log Sighting")),_&&React.createElement("form",{onSubmit:me,className:"mb-4 p-3 bg-dark-subtle rounded-3 shadow-sm border border-secondary border-opacity-25"},React.createElement("div",{className:"row g-2 mb-2"},React.createElement("div",{className:"col-6"},React.createElement("label",{className:"form-label x-small fw-bold text-uppercase"},"Lat"),React.createElement("input",{type:"number",step:"any",className:"form-control form-control-sm bg-dark border-0",value:x.lat,onChange:s=>$(h(v({},x),{lat:s.target.value})),required:!0})),React.createElement("div",{className:"col-6"},React.createElement("label",{className:"form-label x-small fw-bold text-uppercase"},"Lon"),React.createElement("input",{type:"number",step:"any",className:"form-control form-control-sm bg-dark border-0",value:x.lon,onChange:s=>$(h(v({},x),{lon:s.target.value})),required:!0}))),React.createElement("div",{className:"mb-2"},React.createElement("button",{type:"button",className:"btn btn-info btn-sm w-100 rounded-pill",onClick:pe},React.createElement("i",{className:"fa-solid fa-location-crosshairs me-1"})," Get Current Location")),React.createElement("div",{className:"mb-2"},React.createElement("label",{className:"form-label x-small fw-bold text-uppercase"},"Location Name (optional)"),React.createElement("input",{type:"text",className:"form-control form-control-sm bg-dark border-0",value:x.name,onChange:s=>$(h(v({},x),{name:s.target.value})),placeholder:"e.g. Garden, Park..."})),React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label x-small fw-bold text-uppercase"},"Note (optional)"),React.createElement("textarea",{className:"form-control form-control-sm bg-dark border-0",rows:"2",value:x.description,onChange:s=>$(h(v({},x),{description:s.target.value})),placeholder:"Describe the place..."})),React.createElement("button",{type:"submit",className:"btn btn-success btn-sm w-100 rounded-pill"},"Save Sighting")),a.locations&&a.locations.length>0?React.createElement("div",{className:"list-group list-group-flush bg-transparent"},a.locations.sort((s,p)=>new Date(p.created_at)-new Date(s.created_at)).map(s=>React.createElement("div",{key:s.id,className:"list-group-item bg-transparent border-secondary border-opacity-25 px-0 py-3"},React.createElement("div",{className:"d-flex justify-content-between"},React.createElement("h6",{className:"mb-1"},s.name||`Location at ${s.lat.toFixed(4)}, ${s.lon.toFixed(4)}`),React.createElement("span",{className:"text-secondary small"},new Date(s.created_at).toLocaleString())),s.description&&React.createElement("p",{className:"mb-1 small text-secondary"},s.description),React.createElement("a",{href:`https://www.google.com/maps/search/?api=1&query=${s.lat},${s.lon}`,target:"_blank",className:"btn btn-link btn-sm p-0 text-decoration-none"},"View on Maps")))):React.createElement("p",{className:"text-secondary mb-0"},"No locations recorded."))),React.createElement("div",{className:"col-12 col-lg-4"},React.createElement("div",{className:"card border-0 bg-body-tertiary shadow-sm rounded-4 p-4 h-100"},React.createElement("div",{className:"d-flex justify-content-between align-items-center mb-3"},React.createElement("h5",{className:"fw-bold mb-0"},React.createElement("i",{className:"fa-solid fa-clipboard-list me-2 text-primary"}),"Journal"),t&&React.createElement("button",{className:"btn btn-primary btn-sm rounded-pill",onClick:()=>N(!w)},React.createElement("i",{className:`fa-solid ${w?"fa-xmark":"fa-plus"} me-1`}),w?"Cancel":"Add Entry")),w&&React.createElement("form",{onSubmit:M,className:"mb-4 p-3 bg-dark-subtle rounded-3 shadow-sm border border-secondary border-opacity-25"},React.createElement("div",{className:"mb-2"},React.createElement("label",{className:"form-label x-small fw-bold text-uppercase"},"Type"),React.createElement("select",{className:"form-select form-select-sm bg-dark border-0",value:D.type,onChange:s=>r(h(v({},D),{type:s.target.value}))},React.createElement("option",{value:"feeding"},"Feeding"),React.createElement("option",{value:"observation"},"Observation"),React.createElement("option",{value:"medical"},"Medical"),React.createElement("option",{value:"vaccination"},"Vaccination"),React.createElement("option",{value:"vet_visit"},"Vet Visit"),React.createElement("option",{value:"sterilization"},"Sterilization"),React.createElement("option",{value:"medication"},"Medication"))),React.createElement("div",{className:"mb-2"},React.createElement("label",{className:"form-label x-small fw-bold text-uppercase"},"Note"),React.createElement("textarea",{className:"form-control form-control-sm bg-dark border-0",rows:"2",value:D.note,onChange:s=>r(h(v({},D),{note:s.target.value})),placeholder:"Describe what happened..."})),React.createElement("div",{className:"mb-3"},React.createElement("label",{className:"form-label x-small fw-bold text-uppercase"},"Planned Time (optional)"),React.createElement("input",{type:"datetime-local",className:"form-control form-control-sm bg-dark border-0",value:D.planned_at,onChange:s=>r(h(v({},D),{planned_at:s.target.value}))})),React.createElement("button",{type:"submit",className:"btn btn-success btn-sm w-100 rounded-pill"},"Save Entry")),a.records&&a.records.length>0?React.createElement("div",{className:"timeline"},[...a.records].sort((s,p)=>new Date(p.timestamp||p.created_at)-new Date(s.timestamp||s.created_at)).map(s=>React.createElement("div",{key:s.id,className:"mb-4 position-relative ps-4 border-start border-secondary border-opacity-50"},React.createElement("div",{className:"position-absolute start-0 top-0 translate-middle-x bg-body-tertiary border border-secondary p-1 rounded-circle",style:{marginLeft:"-1px"}},React.createElement("div",{className:`rounded-circle ${s.done_at?"bg-success":"bg-warning"}`,style:{width:"8px",height:"8px"}})),React.createElement("div",{className:"d-flex justify-content-between align-items-start mb-1"},React.createElement("div",null,React.createElement("span",{className:"fw-bold text-capitalize"},s.type.replace("_"," ")),!s.done_at&&s.planned_at&&t&&React.createElement("button",{className:"btn btn-link btn-sm text-success p-0 ms-2 text-decoration-none x-small",onClick:()=>ue(s.id)},React.createElement("i",{className:"fa-solid fa-check me-1"}),"Mark Done")),React.createElement("span",{className:"x-small text-secondary"},new Date(s.done_at||s.planned_at||s.timestamp).toLocaleString())),s.note&&React.createElement("p",{className:"small text-secondary mb-0"},s.note),s.done_at&&React.createElement("span",{className:"badge bg-success-subtle text-success border border-success border-opacity-25 x-small"},"Completed"),s.planned_at&&!s.done_at&&React.createElement("span",{className:"badge bg-warning-subtle text-warning border border-warning border-opacity-25 x-small"},"Planned")))):React.createElement("p",{className:"text-secondary mb-0"},"No journal entries yet.")))):null}function W({catId:e,user:t}){let{useState:o,useEffect:n,useRef:i}=React,[a,c]=o({name:"",description:"",color:"",birth_date:"",condition:3,gender:"unknown",is_sterilized:!1,need_attention:!1,tags:[],images:[]}),[l,m]=o(""),[f,y]=o(!!e),[C,b]=o(!1),[w,N]=o(!1),[_,E]=o(null),F=i(null),L=()=>{e&&u.get(`/api/cats/${e}/`).then(d=>{d.birth_date&&(d.birth_date=d.birth_date.substring(0,10)),c(h(v({},d),{tags:d.tags||[],images:d.images||[],color:d.color||"",description:d.description||"",gender:d.gender||"unknown",birth_date:d.birth_date||""})),y(!1)}).catch(d=>{E(d.message),y(!1)})};if(n(()=>{L()},[e]),f)return React.createElement("div",{className:"text-center py-5"},React.createElement("div",{className:"spinner-border"}));let D=d=>{let{name:g,value:S,type:U,checked:V}=d.target;c(O=>h(v({},O),{[g]:U==="checkbox"?V:g==="condition"?parseInt(S):S}))},r=d=>{d.key==="Enter"&&l.trim()&&(d.preventDefault(),(a.tags||[]).find(S=>S.name.toLowerCase()===l.trim().toLowerCase())||c(S=>h(v({},S),{tags:[...S.tags||[],{name:l.trim()}]})),m(""))},x=d=>{c(g=>h(v({},g),{tags:(g.tags||[]).filter(S=>S.name!==d)}))},$=async d=>{d.preventDefault(),b(!0),E(null);try{let g=v({},a);if(g.birth_date?g.birth_date=new Date(g.birth_date).toISOString():delete g.birth_date,e)await u.put(`/api/cats/${e}/`,g);else{let S=await u.post("/api/cats/",g);window.location.hash=`#/cat/view/${S.id}`;return}window.location.hash=`#/cat/view/${e}`}catch(g){E(g.message),b(!1)}},P=async d=>{let g=d.target.files;if(!(!g||g.length===0)){N(!0);try{for(let S=0;S<g.length;S++){let U=new FormData;U.append("file",g[S]),await u.post(`/api/cats/${e}/images`,U)}L()}catch(S){alert("Upload failed: "+S.message)}finally{N(!1),d.target.value=""}}},k=async d=>{if(confirm("Are you sure you want to delete this photo?"))try{await u.del(`/api/cats/${e}/images/${d}`),L()}catch(g){alert("Delete failed: "+g.message)}},R=async()=>{if(confirm("Are you sure you want to delete this cat? This action is reversible but the cat will disappear from the list.")){b(!0);try{await u.del(`/api/cats/${e}/`),window.location.hash="#/"}catch(d){E(d.message),b(!1)}}};return React.createElement("div",{className:"row justify-content-center"},React.createElement("div",{className:"col-12 col-md-10 col-lg-8"},React.createElement("div",{className:"card border-0 bg-body-tertiary shadow-sm rounded-4 p-4 p-md-5"},React.createElement("h2",{className:"fw-bold mb-4"},e?"Edit Cat":"Add New Cat"),_&&React.createElement("div",{className:"alert alert-danger"},_),React.createElement("form",{onSubmit:$},React.createElement("div",{className:"row g-3"},React.createElement("div",{className:"col-12"},React.createElement("label",{className:"form-label text-secondary text-uppercase small fw-bold"},"Name"),React.createElement("input",{type:"text",name:"name",className:"form-control form-control-lg bg-dark border-0 rounded-3",value:a.name,onChange:D,required:!0,placeholder:"Cat's name"})),React.createElement("div",{className:"col-12"},React.createElement("label",{className:"form-label text-secondary text-uppercase small fw-bold"},"Description"),React.createElement("textarea",{name:"description",className:"form-control bg-dark border-0 rounded-3",rows:"3",value:a.description,onChange:D,placeholder:"Physical features, behavior, etc."})),React.createElement("div",{className:"col-md-6"},React.createElement("label",{className:"form-label text-secondary text-uppercase small fw-bold"},"Color"),React.createElement("input",{type:"text",name:"color",className:"form-control bg-dark border-0 rounded-3",value:a.color||"",onChange:D,placeholder:"e.g. Black, Ginger, Tortie"})),React.createElement("div",{className:"col-md-6"},React.createElement("label",{className:"form-label text-secondary text-uppercase small fw-bold"},"Birth Date"),React.createElement("input",{type:"date",name:"birth_date",className:"form-control bg-dark border-0 rounded-3",value:a.birth_date||"",onChange:D})),React.createElement("div",{className:"col-md-6"},React.createElement("label",{className:"form-label text-secondary text-uppercase small fw-bold"},"Condition"),React.createElement("select",{name:"condition",className:"form-select bg-dark border-0 rounded-3 text-white",value:a.condition,onChange:D},React.createElement("option",{value:"1"},"\u{1F640} 1 - Very Bad"),React.createElement("option",{value:"2"},"\u{1F63F} 2 - Bad"),React.createElement("option",{value:"3"},"\u{1F63A} 3 - Normal"),React.createElement("option",{value:"4"},"\u{1F63D} 4 - Good"),React.createElement("option",{value:"5"},"\u{1F63B} 5 - Excellent"))),React.createElement("div",{className:"col-md-6"},React.createElement("label",{className:"form-label text-secondary text-uppercase small fw-bold"},"Gender"),React.createElement("select",{name:"gender",className:"form-select bg-dark border-0 rounded-3",value:a.gender,onChange:D},React.createElement("option",{value:"unknown"},"Unknown"),React.createElement("option",{value:"male"},"Male"),React.createElement("option",{value:"female"},"Female"))),React.createElement("div",{className:"col-md-6"},React.createElement("div",{className:"form-check form-switch mt-2"},React.createElement("input",{className:"form-check-input",type:"checkbox",name:"is_sterilized",id:"chkSterilized",checked:a.is_sterilized,onChange:D}),React.createElement("label",{className:"form-check-label",htmlFor:"chkSterilized"},"Sterilized"))),React.createElement("div",{className:"col-md-6"},React.createElement("div",{className:"form-check form-switch mt-2"},React.createElement("input",{className:"form-check-input",type:"checkbox",name:"need_attention",id:"chkAttention",checked:a.need_attention,onChange:D}),React.createElement("label",{className:"form-check-label",htmlFor:"chkAttention"},"Needs attention \u26A0\uFE0F"))),React.createElement("div",{className:"col-12"},React.createElement("label",{className:"form-label text-secondary text-uppercase small fw-bold"},"Tags"),React.createElement("input",{type:"text",className:"form-control bg-dark border-0 rounded-3 mb-2",value:l,onChange:d=>m(d.target.value),onKeyDown:r,placeholder:"Type tag and press Enter"}),React.createElement("div",null,(a.tags||[]).map(d=>React.createElement("span",{key:d.name,className:"badge bg-secondary me-1 py-2 px-3 rounded-pill"},"#",d.name,React.createElement("button",{type:"button",className:"btn-close btn-close-white ms-2",style:{fontSize:"0.5rem"},onClick:()=>x(d.name)}))))),e&&React.createElement("div",{className:"col-12 mt-4"},React.createElement("div",{className:"d-flex justify-content-between align-items-center mb-2"},React.createElement("label",{className:"form-label text-secondary text-uppercase small fw-bold mb-0"},"Photos"),React.createElement("button",{type:"button",className:"btn btn-outline-primary btn-sm rounded-pill px-3",onClick:()=>F.current.click(),disabled:w},React.createElement("i",{className:"fa-solid fa-plus me-1"})," ",w?"Uploading...":"Add Photo")),React.createElement("input",{type:"file",ref:F,className:"d-none",accept:"image/*",multiple:!0,onChange:P}),React.createElement("div",{className:"row g-2"},a.images&&a.images.length>0?a.images.map(d=>React.createElement("div",{key:d.id,className:"col-4 col-md-3 col-lg-2"},React.createElement("div",{className:"position-relative ratio ratio-1x1 rounded-3 overflow-hidden bg-dark"},React.createElement("img",{src:`/api/cats/${e}/images/${d.id}`,className:"object-fit-cover w-100 h-100",alt:""}),React.createElement("div",{className:"position-absolute top-0 end-0 m-1",style:{zIndex:10}},React.createElement("span",{role:"button",tabIndex:0,className:"bg-body-secondary bg-opacity-75 px-1 rounded-1 d-inline-flex align-items-center text-danger shadow-sm",style:{userSelect:"none",cursor:"pointer",fontSize:"0.8rem"},onClick:()=>k(d.id),title:"Delete photo"},React.createElement("i",{className:"fa-solid fa-trash-can"})))))):React.createElement("div",{className:"col-12"},React.createElement("p",{className:"text-secondary small"},"No photos uploaded yet.")))),React.createElement("div",{className:"col-12 pt-4 d-flex gap-2 flex-wrap"},React.createElement("button",{type:"submit",className:"btn btn-primary btn-lg rounded-pill px-5",disabled:C},C?React.createElement("span",{className:"spinner-border spinner-border-sm me-2"}):null,e?"Save Changes":"Create Cat"),React.createElement("button",{type:"button",className:"btn btn-outline-secondary btn-lg rounded-pill px-4",onClick:()=>window.history.back()},"Cancel"),e&&React.createElement("button",{type:"button",className:"btn btn-outline-danger btn-lg rounded-pill px-4 ms-md-auto",onClick:R,disabled:C},"Delete Cat")))))))}function K({user:e}){let{useState:t,useEffect:o}=React,[n,i]=t([]),[a,c]=t({}),[l,m]=t(!0),[f,y]=t(null);o(()=>{(async()=>{try{let w=new Date,N=new Date;N.setDate(w.getDate()+7);let[_,E]=await Promise.all([u.get(`/api/records/planned?start=${w.toISOString()}&end=${N.toISOString()}`),u.get("/api/cats/")]),F={};E.forEach(L=>{F[L.id]=L}),i(_),c(F),m(!1)}catch(w){y(w.message),m(!1)}})()},[]);let C=async(b,w)=>{try{await u.post(`/api/cats/${b}/records/${w}/done`,{});let N=new Date,_=new Date;_.setDate(N.getDate()+7);let E=await u.get(`/api/records/planned?start=${N.toISOString()}&end=${_.toISOString()}`);i(E)}catch(N){alert("Failed to mark as done: "+N.message)}};return l?React.createElement("div",{className:"text-center py-5"},React.createElement("div",{className:"spinner-border text-primary"})):f?React.createElement("div",{className:"alert alert-danger"},"Error: ",f):React.createElement("div",{className:"container"},React.createElement("div",{className:"d-flex justify-content-between align-items-center mb-4"},React.createElement("h2",{className:"mb-0 fw-bold"},React.createElement("i",{className:"fa-solid fa-calendar-week me-2 text-primary"}),"Upcoming Events"),React.createElement("span",{className:"badge bg-secondary rounded-pill"},n.length," events")),n.length===0?React.createElement("div",{className:"text-center py-5 bg-body-tertiary rounded-4 shadow-sm"},React.createElement("i",{className:"fa-solid fa-calendar-check fa-4x mb-3 opacity-25"}),React.createElement("p",{className:"lead text-secondary"},"No upcoming events for the next 7 days.")):React.createElement("div",{className:"card border-0 bg-body-tertiary shadow-sm rounded-4 overflow-hidden"},React.createElement("div",{className:"list-group list-group-flush bg-transparent"},n.map(b=>{let w=a[b.cat_id]||{name:"Unknown Cat"},N=new Date(b.planned_at||b.timestamp);return React.createElement("div",{key:b.id,className:"list-group-item bg-transparent border-secondary border-opacity-25 p-4"},React.createElement("div",{className:"row align-items-center g-3"},React.createElement("div",{className:"col-auto"},React.createElement("div",{className:"bg-primary bg-opacity-10 text-primary rounded-3 p-3 text-center",style:{width:"70px"}},React.createElement("div",{className:"fw-bold fs-4"},N.getDate()),React.createElement("div",{className:"x-small text-uppercase"},N.toLocaleString("en",{month:"short"})))),React.createElement("div",{className:"col"},React.createElement("div",{className:"d-flex justify-content-between align-items-start mb-1"},React.createElement("h5",{className:"mb-0 fw-bold"},React.createElement("a",{href:`#/cat/view/${b.cat_id}`,className:"text-decoration-none text-reset"},w.name),React.createElement("span",{className:"ms-2 badge bg-info-subtle text-info border border-info border-opacity-25 x-small text-capitalize"},b.type.replace("_"," "))),React.createElement("span",{className:"text-secondary small fw-bold"},React.createElement("i",{className:"fa-regular fa-clock me-1"}),N.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))),b.note&&React.createElement("p",{className:"mb-0 small text-secondary fst-italic"},'"',b.note,'"'),b.recurrence&&React.createElement("div",{className:"mt-1 x-small text-info opacity-75"},React.createElement("i",{className:"fa-solid fa-arrows-rotate me-1"}),"Every ",b.interval," ",b.recurrence)),e&&React.createElement("div",{className:"col-12 col-md-auto text-md-end"},React.createElement("button",{className:"btn btn-outline-success btn-sm rounded-pill px-3",onClick:()=>C(b.cat_id,b.id)},React.createElement("i",{className:"fa-solid fa-check me-1"})," Mark Done"))))}))))}function Z({config:e}){let{googleEnabled:t,oidcEnabled:o,devLogin:n,authorizationEndpoint:i}=e;return React.createElement("div",{className:"row justify-content-center py-5"},React.createElement("div",{className:"col-12 col-sm-8 col-md-6 col-lg-4 text-center"},React.createElement("h3",{className:"mb-4"},"Sign in to CatWatch"),React.createElement("p",{className:"text-secondary mb-4"},"You will be redirected to the secure login page."),React.createElement("div",{className:"d-grid gap-3"},t||o||n?React.createElement("a",{href:i||"/auth/login",className:"btn btn-primary btn-lg py-3"},React.createElement("i",{className:"fa-solid fa-right-to-bracket me-2"}),"Proceed to Login"):React.createElement("div",{className:"alert alert-warning"},"No authorization methods are configured."))))}function ee({user:e}){let{useState:t,useEffect:o}=React,[n,i]=t([]),[a,c]=t([]),[l,m]=t(!0),[f,y]=t(!1),[C,b]=t({name:"",email:""}),[w,N]=t(!1);o(()=>{e&&(m(!0),b({name:e.name||"",email:e.email||""}),Promise.all([u.get("/api/user/likes"),u.get("/api/user/audit")]).then(([r,x])=>{i(r||[]),c(x||[]),m(!1)}).catch(r=>{console.error(r),m(!1)}))},[e]);let _=async()=>{try{await u.post("/api/auth/logout",{}),localStorage.removeItem("token"),window.location.hash="#/",window.location.reload()}catch(r){alert("Logout failed: "+r.message)}},E=r=>{i(x=>x.filter($=>$.id!==r))},F=async r=>{r.preventDefault();try{let x=await u.patch("/api/user",C);window.location.reload()}catch(x){alert("Update failed: "+x.message)}},L=async()=>{try{window.location.href="/api/user/export"}catch(r){alert("Export failed: "+r.message)}},D=async()=>{if(window.confirm("Are you absolutely sure you want to delete your account? This will remove your likes, bot links, and anonymize your records. This action is irreversible.")){N(!0);try{await u.del("/api/user"),window.location.hash="#/",window.location.reload()}catch(r){alert("Deletion failed: "+r.message),N(!1)}}};return e?React.createElement("div",{className:"container py-4",style:{maxWidth:"900px"}},React.createElement("div",{className:"card border-0 bg-body-tertiary shadow-sm rounded-4 p-4 mb-5"},React.createElement("div",{className:"d-flex align-items-center flex-wrap gap-4"},React.createElement(j,{user:e,size:100,className:"border shadow-sm"}),React.createElement("div",{className:"flex-grow-1"},f?React.createElement("form",{onSubmit:F},React.createElement("div",{className:"mb-2"},React.createElement("input",{type:"text",className:"form-control form-control-sm rounded-pill",placeholder:"Name",value:C.name,onChange:r=>b(h(v({},C),{name:r.target.value})),required:!0})),React.createElement("div",{className:"mb-3"},React.createElement("input",{type:"email",className:"form-control form-control-sm rounded-pill",placeholder:"Email",value:C.email,onChange:r=>b(h(v({},C),{email:r.target.value})),required:!0})),React.createElement("div",{className:"d-flex gap-2"},React.createElement("button",{type:"submit",className:"btn btn-primary btn-sm rounded-pill px-3"},"Save"),React.createElement("button",{type:"button",className:"btn btn-light btn-sm rounded-pill px-3",onClick:()=>y(!1)},"Cancel"))):React.createElement(React.Fragment,null,React.createElement("h2",{className:"fw-bold mb-1"},e.name||"Volunteer"),React.createElement("p",{className:"text-secondary mb-3"},e.email),React.createElement("div",{className:"d-flex gap-2"},React.createElement("button",{className:"btn btn-outline-primary btn-sm rounded-pill px-3",onClick:()=>y(!0)},React.createElement("i",{className:"fa-solid fa-user-pen me-2"}),"Edit Profile"),React.createElement("button",{className:"btn btn-outline-danger btn-sm rounded-pill px-3",onClick:_},React.createElement("i",{className:"fa-solid fa-right-from-bracket me-2"}),"Sign Out"))))),React.createElement("div",{className:"mt-4 pt-3 border-top d-flex justify-content-between align-items-center"},React.createElement("div",{className:"small text-secondary"},React.createElement("i",{className:"fa-solid fa-shield-halved me-2"}),"Manage your personal data"),React.createElement("div",{className:"d-flex gap-3 align-items-center"},React.createElement("button",{className:"btn btn-link btn-sm text-primary text-decoration-none",onClick:L},React.createElement("i",{className:"fa-solid fa-download me-1"}),"Export Data"),React.createElement("button",{className:"btn btn-link btn-sm text-danger text-decoration-none",onClick:D,disabled:w},w?"Deleting...":"Delete Account")))),React.createElement("div",{className:"d-flex justify-content-between align-items-center mb-4"},React.createElement("h4",{className:"fw-bold mb-0"},React.createElement("i",{className:"fa-solid fa-heart text-danger me-2"}),"Favorite Cats"),React.createElement("span",{className:"badge bg-secondary rounded-pill"},n.length)),l?React.createElement("div",{className:"text-center py-5"},React.createElement("div",{className:"spinner-border text-primary"})):n.length===0?React.createElement("div",{className:"text-center py-5 bg-body-tertiary rounded-4 border border-dashed"},React.createElement("i",{className:"fa-regular fa-heart fa-3x mb-3 opacity-25"}),React.createElement("p",{className:"text-secondary lead"},"You haven't liked any cats yet."),React.createElement("a",{href:"#/",className:"btn btn-outline-primary rounded-pill px-4"},"Explore Cats")):React.createElement("div",{className:"row row-cols-1 row-cols-sm-2 row-cols-md-3 g-4"},n.map(r=>React.createElement("div",{key:r.id,className:"col"},React.createElement(I,{cat:r,user:e,onUnliked:E})))),React.createElement("div",{className:"d-flex justify-content-between align-items-center mt-5 mb-4"},React.createElement("h4",{className:"fw-bold mb-0"},React.createElement("i",{className:"fa-solid fa-clock-rotate-left text-primary me-2"}),"Activity Log"),React.createElement("span",{className:"badge bg-secondary rounded-pill"},a.length)),React.createElement("div",{className:"card border-0 bg-body-tertiary shadow-sm rounded-4 overflow-hidden mb-5"},React.createElement("div",{className:"table-responsive"},React.createElement("table",{className:"table table-hover mb-0"},React.createElement("thead",{className:"table-light"},React.createElement("tr",null,React.createElement("th",{className:"border-0 ps-4 small text-uppercase fw-bold text-secondary"},"Time"),React.createElement("th",{className:"border-0 small text-uppercase fw-bold text-secondary"},"Action"),React.createElement("th",{className:"border-0 text-end pe-4 small text-uppercase fw-bold text-secondary"},"Status"))),React.createElement("tbody",{className:"border-top-0"},a.map(r=>React.createElement("tr",{key:r.id},React.createElement("td",{className:"ps-4 text-secondary small align-middle"},new Date(r.ts).toLocaleString([],{dateStyle:"short",timeStyle:"short"})),React.createElement("td",{className:"align-middle"},React.createElement("div",{className:"fw-medium text-capitalize mb-0"},r.method.toLowerCase()==="post"?"Created":r.method.toLowerCase()==="put"?"Updated":r.method.toLowerCase()==="delete"?"Deleted":r.method," ",r.target_type),React.createElement("div",{className:"text-secondary x-small font-monospace",style:{fontSize:"0.75rem"}},r.route)),React.createElement("td",{className:"text-end pe-4 align-middle"},React.createElement("span",{className:`badge rounded-pill ${r.status==="success"?"bg-success-subtle text-success":"bg-danger-subtle text-danger"}`},r.status)))),a.length===0&&!l&&React.createElement("tr",null,React.createElement("td",{colSpan:"3",className:"text-center py-5 text-secondary"},React.createElement("i",{className:"fa-solid fa-ghost fa-2x mb-2 opacity-25 d-block"}),"No recent activity found."))))))):React.createElement("div",{className:"text-center py-5"},React.createElement("p",{className:"lead text-secondary"},"Please sign in to view your profile."),React.createElement("a",{href:"#/signin",className:"btn btn-primary rounded-pill px-4"},"Sign In"))}function te(){return React.createElement("div",{className:"container py-5",style:{maxWidth:"800px"}},React.createElement("div",{className:"card border-0 bg-body-tertiary shadow-sm rounded-4 p-5"},React.createElement("h1",{className:"fw-bold mb-4"},"Privacy Policy"),React.createElement("p",{className:"lead text-secondary mb-5"},"We care about your privacy and the protection of your personal data."),React.createElement("section",{className:"mb-5"},React.createElement("h4",{className:"fw-bold mb-3"},"1. Data Controller"),React.createElement("p",null,"The CatWatch community project (Housing Cooperative Neighbors) operates this service. Data is stored and processed within the European Union (Cyprus).")),React.createElement("section",{className:"mb-5"},React.createElement("h4",{className:"fw-bold mb-3"},"2. Data We Collect"),React.createElement("ul",{className:"list-group list-group-flush bg-transparent"},React.createElement("li",{className:"list-group-item bg-transparent border-0 px-0"},React.createElement("strong",null,"Account Information:")," Name, email address, and profile picture (via OAuth providers)."),React.createElement("li",{className:"list-group-item bg-transparent border-0 px-0"},React.createElement("strong",null,"Volunteer Activity:")," Records of cat feeding/checks, liked cats, and associations with Telegram chats."),React.createElement("li",{className:"list-group-item bg-transparent border-0 px-0"},React.createElement("strong",null,"Audit Logs:")," Records of your mutating actions (create, update, delete) to ensure system integrity. We do not store your IP address or browser fingerprints in our database permanently."))),React.createElement("section",{className:"mb-5"},React.createElement("h4",{className:"fw-bold mb-3"},"3. Purpose and Legal Basis"),React.createElement("p",null,"We process your data based on ",React.createElement("strong",null,"Contractual Necessity")," (to provide the service you signed up for) and ",React.createElement("strong",null,"Legitimate Interest")," (to coordinate cat care and prevent abuse).")),React.createElement("section",{className:"mb-5"},React.createElement("h4",{className:"fw-bold mb-3"},"4. Cookies"),React.createElement("p",null,"We use strictly necessary cookies for authentication (`access_token`, `refresh_token`). These are required for the site to function securely.")),React.createElement("section",{className:"mb-5"},React.createElement("h4",{className:"fw-bold mb-3"},"5. Third-Party Services"),React.createElement("p",null,"- ",React.createElement("strong",null,"OAuth Providers (Google/OIDC):")," For secure authentication.",React.createElement("br",null),"- ",React.createElement("strong",null,"Telegram:")," If you choose to link your bot notifications.",React.createElement("br",null),"- ",React.createElement("strong",null,"CloudFlare:")," For security and performance optimization (operates as a processor).")),React.createElement("section",{className:"mb-5"},React.createElement("h4",{className:"fw-bold mb-3"},"6. Your Rights (GDPR)"),React.createElement("p",null,"Under GDPR, you have the right to:"),React.createElement("ul",null,React.createElement("li",null,"Access and export your data."),React.createElement("li",null,"Rectify inaccurate data (via Profile page)."),React.createElement("li",null,'Erase your data (via Profile page - "Delete Account").'),React.createElement("li",null,"Object to processing or restrict it.")),React.createElement("p",null,"To exercise your rights or if you have questions, please contact the community volunteer leads.")),React.createElement("div",{className:"mt-5 pt-4 border-top text-secondary small"},"Last updated: February 18, 2026")))}function ae(){let{useState:e,useEffect:t}=React,[o,n]=e(!1);t(()=>{localStorage.getItem("gdpr_consent")||n(!0)},[]);let i=()=>{localStorage.setItem("gdpr_consent","true"),n(!1)};return o?React.createElement("div",{className:"fixed-bottom p-3 z-3"},React.createElement("div",{className:"card border-0 shadow-lg bg-dark text-white rounded-4 overflow-hidden"},React.createElement("div",{className:"card-body p-4"},React.createElement("div",{className:"d-flex flex-column flex-md-row align-items-md-center gap-3"},React.createElement("div",{className:"flex-grow-1"},React.createElement("h6",{className:"fw-bold mb-1"},React.createElement("i",{className:"fa-solid fa-cookie-bite me-2 text-warning"}),"Cookie Consent & Privacy"),React.createElement("p",{className:"small mb-0 opacity-75"},"We use strictly necessary cookies for authentication and security. By using our site, you agree to our",React.createElement("a",{href:"#/privacy",className:"text-white text-decoration-underline ms-1"},"Privacy Policy"),".")),React.createElement("div",{className:"d-flex gap-2"},React.createElement("button",{className:"btn btn-primary btn-sm rounded-pill px-4",onClick:i},"Got it")))))):null}function se(){let{useEffect:e}=React,t=q(),{config:o,user:n,setUser:i,theme:a,setTheme:c}=H();e(()=>{n||u.get("/api/user").then(i).catch(()=>{})},[t]);let l=null;if(t.startsWith("#/cat/view/")){let m=t.replace("#/cat/view/","").split("?")[0].replace(/\/$/,"");l=React.createElement(Q,{key:`view-${m}`,catId:m,user:n})}else if(t.startsWith("#/cat/edit/")){let m=t.replace("#/cat/edit/","").split("?")[0].replace(/\/$/,"");l=React.createElement(W,{key:`edit-${m}`,catId:m,user:n})}else t==="#/cat/new"?l=React.createElement(W,{key:"new",user:n}):t==="#/upcoming"?l=React.createElement(K,{key:"upcoming",user:n}):t==="#/me"?l=React.createElement(ee,{key:"me",user:n}):t==="#/privacy"?l=React.createElement(te,{key:"privacy"}):t==="#/signin"?l=React.createElement(Z,{key:"signin",config:o}):l=React.createElement(J,{key:"main",user:n});return React.createElement("div",null,React.createElement(Y,{theme:a,setTheme:c,user:n}),React.createElement("div",{className:"container-fluid py-3"},l),React.createElement(ae,null))}var we=ReactDOM.createRoot(document.getElementById("app"));we.render(React.createElement(se,null));})();
//# sourceMappingURL=app.bundle.js.map
